version: '3.8'

services:
  frontend-prod:
    build:
      context: .
      dockerfile: Dockerfile
      target: production
    container_name: bcflame_frontend_prod
    restart: unless-stopped
    environment:
      NODE_ENV: production
      NEXT_TELEMETRY_DISABLED: 1
      # Configure these based on your production Strapi URL
      NEXT_PUBLIC_STRAPI_URL: ${NEXT_PUBLIC_STRAPI_URL:-http://localhost:1337}
      NEXT_PUBLIC_SITE_URL: ${NEXT_PUBLIC_SITE_URL:-http://localhost:3000}
      NEXT_PUBLIC_APP_NAME: BC Flame Premium Portal
    ports:
      - "${FRONTEND_PORT:-3000}:3000"
    networks:
      - bcflame_network
    healthcheck:
      test: ["CMD-SHELL", "wget --no-verbose --tries=1 --spider http://localhost:3000 || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 3

networks:
  bcflame_network:
    driver: bridge
